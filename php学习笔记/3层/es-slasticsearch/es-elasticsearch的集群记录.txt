https://cloud.tencent.com/developer/article/1638738

目前的数据没有那么多，可以先
不考虑分片   
备份的话  要用到多个节点，多台机器，那么就可能要申请机器了  最少要 3台。
这样的话  可以有1个主节点 2个从节点  也可以通过选举的方式避免脑裂的情况  (3/2+1)
一个分片是30G左右，然后每个分片呢备一个副本分片
product

目前的数据量是   占用空间 


线上情况：

品牌案例  1630 条
门店案例 约15W条  146927条 

品宣库  
blj_brand_characters   240
blj_shop_characters 1.6W  15652

装修知识  15W条
blj_brand_article    150830

产品库     14W 
blj_shop_goods  140815 


50W

500W

100W  占用了500M -700M  
500W  占用 3.5G

Elasticsearch默认安装后设置的内存是1GB

export ES_HEAP_SIZE=10g

一般来说设置ES_HEAP_SIZE环境变量，比直接写-Xmx10g  -Xms10g更好一点。

把内存的一半给Lucene
32GB是ES一个内存设置限制
事实上jvm在内存小于32G的时候会采用一个内存对象指针压缩技术。

设置命令如下：
export ES_HEAP_SIZE=10g
此外，你也可以通过命令行参数的形式，在程序启动的时候把内存大小传递给它：
./bin/elasticsearch -Xmx10g -Xms10g


 查看内存设置
 vim /etc/elasticsearch/jvm.options

 默认是4G，已经够用了
 
 
 number_of_shards
每个索引的主分片数，默认值是 5 。这个配置在索引创建后不能修改。
number_of_replicas
每个主分片的副本数，默认值是 1 。对于活动的索引库，这个配置可以随时修改。


max_map_count文件包含限制一个进程可以拥有的VMA(虚拟内存区域)的数量。虚拟内存区域是一个连续的虚拟地址空间区域。在进程的生命周期中，每当程序尝试在内存中映射文件，链接到共享内存段，或者分配堆空间的时候，这些区域将被创建。调优这个值将限制进程可拥有VMA的数量。限制一个进程拥有VMA的总数可能导致应用程序出错，因为当进程达到了VMA上线但又只能释放少量的内存给其他的内核进程使用时，操作系统会抛出内存不足的错误。如果你的操作系统在NORMAL区域仅占用少量的内存，那么调低这个值可以帮助释放内存给内核用。



